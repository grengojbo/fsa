:tocdepth: 2

.. _signals:

Разработка FSAdmin
==================
./manage.py syncdb
./manage.py do_admin
./manage.py do_userprofile
./manage.py load_fs
./manage.py load_lcr --gw=3 --site=1 --format_csv=1 /fsa/lcr/fixtures/test-lcr.csv
gw ID - 
site ID
format_csv
Для загрузки LCR необходимо прописать в таблице gateway.sofiagateway lcr_format -> digits,name,rate,other,date_start,date_end
где 

name - название (Ukraine-Mobile KYIV STAR)
rate - цена (0.01)
currency - тип валюты (USD)
other - любая колонка которую необходимо пропустить
date_start
date_end
digits - код страны + код оператора (38044 - Украина Киев)
pref_digits - обрабатывает шаблоны
7 (495, 499) => 7495, 7499
61 (15-17, 4) = > 6115, 6116, 6117, 614 
98170-98172;9213; 9219; => 98170, 98171, 98172, 9213, 9219
Обязательно должны быть поля digits или pref_digits

./manage.py graph_models contact tariff gateway dialplan lcr server cdr directory base |dot -Tpng -o test.png



./manage.py startmigration appname --initial # новая

./manage.py convert_to_south appname # конвертируем
./manage.py startmigration appname new_tables --auto
./manage.py migrate appname 0001 --fake # говорит о том, что миграция выполнена и последующие миграции её трогать не будут.
./manage.py migrate --db-dry-run # для проверки
./manage.py migrate --list # список миграций 


./manage.py dumpdata --format=xml --indent=1 server.Server > server.xml
./manage.py dumpdata --format=json --indent=1 server.conf > ../../fsa/fsa/server/fixtures/server_conf.json
./manage.py dumpdata --format=json --indent=1 server.csvbase > ../../fsa/fsa/server/fixtures/csvbase.json
./manage.py dumpdata --format=json --indent=1 server.SipProfile > ../../fsa/fsa/server/fixtures/sipprofile.json
./manage.py dumpdata --format=json --indent=1 server.alias > alias.json
./manage.py dumpdata --format=json --indent=1 acl > acl.json
./manage.py dumpdata --format=json --indent=1 dialplan.extension > extension.json
./manage.py dumpdata --format=json --indent=1 dialplan.context > context.json
./manage.py dumpdata --format=xml --indent=1 numberplan > ../../fsa/fsa/numberplan/fixtures/testnp.xml
./manage.py dumpdata --format=json --indent=1 grappelli > ../../fsa/fsa/core/fixtures/fsa_grappelli.json

Удаляем следующие файлы
/conf/autoload_configs/acl.conf.xml
/conf/autoload_configs/event_socket.conf.xml
/conf/autoload_configs/local_stream.conf.xml
/conf/autoload_configs/limit.conf.xml

lua.conf.xml
spidermonkey.conf.xml
voicemail.conf.xml
fifo.conf.xml
cdr_csv.conf.xml
enum.conf.xml
python.conf.xml
java.conf.xml
perl.conf.xml
sofia.conf.xml
xml_cdr.conf.xml
post_load_modules.conf.xml
